diff -rwu ORIGINAL_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java MODIFIED_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java
--- ORIGINAL_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java
+++ MODIFIED_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java
@@ -110,12 +110,15 @@
           computeDerivatives(stepStart, y, yDotK[0]);
         }
         if firstTime {
-          final double[] scale;
+          final double[] scale = new double[y0.length];
           if (vecAbsoluteTolerance == null) {
-            scale = new double[y0.length];
-            java.util.Arrays.fill(scale, scalAbsoluteTolerance);
+            for (int i = 0; i < scale.length; ++i) {
+              scale[i] = scalAbsoluteTolerance + scalRelativeTolerance * Math.abs(y[i]);
+            }
           } else {
-            scale = vecAbsoluteTolerance;
+            for (int i = 0; i < scale.length; ++i) {
+              scale[i] = vecAbsoluteTolerance[i] + vecRelativeTolerance[i] * Math.abs(y[i]);
+            }
           }
           hNew =
               initializeStep(
