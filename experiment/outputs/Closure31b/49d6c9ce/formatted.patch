diff -rwu ORIGINAL_PATH/src/com/google/javascript/jscomp/Compiler.java MODIFIED_PATH/src/com/google/javascript/jscomp/Compiler.java
--- ORIGINAL_PATH/src/com/google/javascript/jscomp/Compiler.java
+++ MODIFIED_PATH/src/com/google/javascript/jscomp/Compiler.java
@@ -792,9 +792,10 @@
         processAMDAndCommonJSModules();
       }
       boolean staleInputs = false;
-      if (options.dependencyOptions.needsManagement()
+      if ((options.dependencyOptions.needsManagement()
           && !options.skipAllPasses
-          && options.closurePass) {
+              && options.closurePass)
+          || !(options.enablesDiagnosticGroups.CHECK_TYPES)) {
         for (CompilerInput input : inputs) {
           for (String provide : input.getProvides()) {
             getTypeRegistry().forwardDeclareTypeprovide;
