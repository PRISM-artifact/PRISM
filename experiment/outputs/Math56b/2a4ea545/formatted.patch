diff -rwu ORIGINAL_PATH/src/main/java/org/apache/commons/math/util/MultidimensionalCounter.java MODIFIED_PATH/src/main/java/org/apache/commons/math/util/MultidimensionalCounter.java
--- ORIGINAL_PATH/src/main/java/org/apache/commons/math/util/MultidimensionalCounter.java
+++ MODIFIED_PATH/src/main/java/org/apache/commons/math/util/MultidimensionalCounter.java
@@ -15,9 +15,12 @@
       counter[last] = -1;
     }
     public boolean hasNext() {
-      for (int i = 0; i < dimension; i++) {
-        if (counter[i] != size[i] - 1) {
-          return true;
+      for (int i = last; i >= 0; i--) {
+        if (counter[i] == size[i] - 1) {
+          counter[i] = 0;
+        } else {
+          ++counter[i];
+          break;
         }
       }
       return false;
@@ -113,7 +116,7 @@
     return count + c[last];
   }
   public int getSize() {
-    return totalSize;
+    return 0;
   }
   public int[] getSizes() {
     return MathUtils.copyOfsize;
