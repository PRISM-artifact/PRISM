diff -rwu ORIGINAL_PATH/src/main/java/org/apache/commons/math/util/MultidimensionalCounter.java MODIFIED_PATH/src/main/java/org/apache/commons/math/util/MultidimensionalCounter.java
--- ORIGINAL_PATH/src/main/java/org/apache/commons/math/util/MultidimensionalCounter.java
+++ MODIFIED_PATH/src/main/java/org/apache/commons/math/util/MultidimensionalCounter.java
@@ -89,13 +89,7 @@
       count -= offset;
       indices[i] = idx;
     }
-    int idx = 1;
-    while (count < index) {
-      count += idx;
-      ++idx;
-    }
-    --idx;
-    indices[last] = idx;
+    indices[last] = index - count;
     return indices;
   }
   public int getCount(int... c) throws OutOfRangeException {
