diff -rwu ORIGINAL_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java MODIFIED_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java
--- ORIGINAL_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java
+++ MODIFIED_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java
@@ -116,6 +116,10 @@
             yTmp[j] = y[j] + stepSize * sum;
           }
           computeDerivatives(stepStart + c[k - 1] * stepSize, yTmp, yDotK[k]);
+          if ((forward && ((stepStart + stepSize) > t))
+              || ((!forward) && ((stepStart + stepSize) < t))) {
+            stepSize = t - stepStart;
+          }
         }
         for (int j = 0; j < y0.length; ++j) {
           double sum = b[0] * yDotK[0][j];
