diff -rwu ORIGINAL_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java MODIFIED_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java
--- ORIGINAL_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java
+++ MODIFIED_PATH/src/main/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java
@@ -107,6 +107,15 @@
           firstTime = false;
         }
         stepSize = hNew;
+        if forward {
+          if (stepStart + stepSize >= t) {
+            stepSize = t - stepStart;
+          }
+        } else {
+          if (stepStart + stepSize <= t) {
+            stepSize = t - stepStart;
+          }
+        }
         for (int k = 1; k < stages; ++k) {
           for (int j = 0; j < y0.length; ++j) {
             double sum = a[k - 1][0] * yDotK[0][j];
