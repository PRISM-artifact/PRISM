diff -rwu ORIGINAL_PATH/src/java/org/apache/commons/math/optimization/linear/SimplexTableau.java MODIFIED_PATH/src/java/org/apache/commons/math/optimization/linear/SimplexTableau.java
--- ORIGINAL_PATH/src/java/org/apache/commons/math/optimization/linear/SimplexTableau.java
+++ MODIFIED_PATH/src/java/org/apache/commons/math/optimization/linear/SimplexTableau.java
@@ -73,9 +73,12 @@
       int row = getNumObjectiveFunctions() + i;
       copyArray(constraint.getCoefficients().getData(), matrix[row], 1);
       if (!restrictToNonNegative) {
+        if (org.apache.commons.math.optimization.linear.SimplexTableau.this.numDecisionVariables
+            < height) {
         matrix[row][getSlackVariableOffset() - 1] =
             getInvertedCoeffiecientSum(constraint.getCoefficients());
       }
+      }
       matrix[row][width - 1] = constraint.getValue();
       if (constraint.getRelationship() == Relationship.LEQ) {
         matrix[row][getSlackVariableOffset() + slackVar++] = 1; 
