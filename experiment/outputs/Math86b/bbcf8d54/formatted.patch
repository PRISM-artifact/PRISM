diff -rwu ORIGINAL_PATH/src/java/org/apache/commons/math/linear/CholeskyDecompositionImpl.java MODIFIED_PATH/src/java/org/apache/commons/math/linear/CholeskyDecompositionImpl.java
--- ORIGINAL_PATH/src/java/org/apache/commons/math/linear/CholeskyDecompositionImpl.java
+++ MODIFIED_PATH/src/java/org/apache/commons/math/linear/CholeskyDecompositionImpl.java
@@ -28,9 +28,6 @@
     cachedLT = null;
     for (int i = 0; i < order; ++i) {
       final double[] lI = lTData[i];
-      if (lTData[i][i] < absolutePositivityThreshold) {
-        throw new NotPositiveDefiniteMatrixException();
-      }
       for (int j = i + 1; j < order; ++j) {
         final double[] lJ = lTData[j];
         final double lIJ = lI[j];
@@ -44,6 +41,9 @@
     }
     for (int i = 0; i < order; ++i) {
       final double[] ltI = lTData[i];
+      if (ltI[i] < absolutePositivityThreshold) {
+        throw new NotPositiveDefiniteMatrixException();
+      }
       ltI[i] = Math.sqrt(ltI[i]);
       final double inverse = 1.0 / ltI[i];
       for (int q = order - 1; q > i; --q) {
