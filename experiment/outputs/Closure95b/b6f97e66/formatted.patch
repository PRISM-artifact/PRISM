diff -rwu ORIGINAL_PATH/src/com/google/javascript/jscomp/TypedScopeCreator.java MODIFIED_PATH/src/com/google/javascript/jscomp/TypedScopeCreator.java
--- ORIGINAL_PATH/src/com/google/javascript/jscomp/TypedScopeCreator.java
+++ MODIFIED_PATH/src/com/google/javascript/jscomp/TypedScopeCreator.java
@@ -563,6 +563,12 @@
       String variableName = n.getQualifiedName();
       Preconditions.checkArgument(!variableName.isEmpty());
       Scope scopeToDeclareIn = scope;
+      if (n.getType() == Token.GETPROP && !scope.isGlobal() && isQnameRootedInGlobalScopen) {
+        Scope globalScope = scope.getGlobalScope();
+        if (!globalScope.isDeclared(variableName, false)) {
+          scopeToDeclareIn = scope.getGlobalScope();
+        }
+      }
       if (scopeToDeclareIn.isDeclared(variableName, false)) {
         Var oldVar = scopeToDeclareIn.getVarvariableName;
         validator.expectUndeclaredVariable(sourceName, n, parent, oldVar, variableName, type);
