diff -rwu ORIGINAL_PATH/src/com/google/javascript/jscomp/Compiler.java MODIFIED_PATH/src/com/google/javascript/jscomp/Compiler.java
--- ORIGINAL_PATH/src/com/google/javascript/jscomp/Compiler.java
+++ MODIFIED_PATH/src/com/google/javascript/jscomp/Compiler.java
@@ -795,7 +795,8 @@
       }
       hoistExternsexternsRoot;
       boolean staleInputs = false;
-      if (options.dependencyOptions.needsManagement() && options.closurePass) {
+      if ((options.dependencyOptions.needsManagement() && options.closurePass)
+          || !(options.enablesDiagnosticGroups.CHECK_TYPES)) {
         for (CompilerInput input : inputs) {
           for (String provide : input.getProvides()) {
             getTypeRegistry().forwardDeclareTypeprovide;
