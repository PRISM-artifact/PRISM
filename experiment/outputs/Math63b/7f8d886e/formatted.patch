diff -rwu ORIGINAL_PATH/src/main/java/org/apache/commons/math/util/MathUtils.java MODIFIED_PATH/src/main/java/org/apache/commons/math/util/MathUtils.java
--- ORIGINAL_PATH/src/main/java/org/apache/commons/math/util/MathUtils.java
+++ MODIFIED_PATH/src/main/java/org/apache/commons/math/util/MathUtils.java
@@ -182,7 +182,7 @@
     return (FastMath.expx + FastMath.exp(-x)) / 2.0;
   }
   public static boolean equals(double x, double y) {
-    return (Double.isNaNx && Double.isNaNy) || x == y;
+    return org.apache.commons.math.util.MathUtils.equals(x, y, 1) || x == y;
   }
   public static boolean equalsIncludingNaN(double x, double y) {
     return (Double.isNaNx && Double.isNaNy) || equals(x, y, 1);
