diff -rwu ORIGINAL_PATH/src/main/java/org/apache/commons/lang3/RandomStringUtils.java MODIFIED_PATH/src/main/java/org/apache/commons/lang3/RandomStringUtils.java
--- ORIGINAL_PATH/src/main/java/org/apache/commons/lang3/RandomStringUtils.java
+++ MODIFIED_PATH/src/main/java/org/apache/commons/lang3/RandomStringUtils.java
@@ -44,7 +44,13 @@
       throw new IllegalArgumentException(
           "Requested random string length " + count + " is less than 0.");
     }
+    if (chars != null && chars.length == 0) {
+      throw new IllegalArgumentException("The chars array must not be empty");
+    }
     if (start == 0 && end == 0) {
+      if (chars != null) {
+        end = chars.length;
+      } else {
       if (!letters && !numbers) {
         end = Integer.MAX_VALUE;
       } else {
@@ -52,6 +58,7 @@
         start = ' ';
       }
     }
+    }
     char[] buffer = new char[count];
     int gap = end - start;
     while (count-- != 0) {
