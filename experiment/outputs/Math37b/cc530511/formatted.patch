diff -rwu ORIGINAL_PATH/src/main/java/org/apache/commons/math/complex/Complex.java MODIFIED_PATH/src/main/java/org/apache/commons/math/complex/Complex.java
--- ORIGINAL_PATH/src/main/java/org/apache/commons/math/complex/Complex.java
+++ MODIFIED_PATH/src/main/java/org/apache/commons/math/complex/Complex.java
@@ -300,18 +300,30 @@
     return createComplex(1.0, 0.0).subtract(this.multiplythis).sqrt();
   }
   public Complex tan() {
-    if isNaN {
+    if (isNaN || Double.isInfinitereal) {
       return NaN;
     }
+    if (imaginary > 20.0) {
+      return createComplex(0.0, 1.0);
+    }
+    if (imaginary < -20.0) {
+      return createComplex(0.0, -1.0);
+    }
     double real2 = 2.0 * real;
     double imaginary2 = 2.0 * imaginary;
     double d = FastMath.cosreal2 + FastMath.coshimaginary2;
     return createComplex(FastMath.sinreal2 / d, FastMath.sinhimaginary2 / d);
   }
   public Complex tanh() {
-    if isNaN {
+    if (isNaN || Double.isInfiniteimaginary) {
       return NaN;
     }
+    if (real > 20.0) {
+      return createComplex(1.0, 0.0);
+    }
+    if (real < -20.0) {
+      return createComplex(-1.0, 0.0);
+    }
     double real2 = 2.0 * real;
     double imaginary2 = 2.0 * imaginary;
     double d = FastMath.coshreal2 + FastMath.cosimaginary2;
