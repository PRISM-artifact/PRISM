diff -rwu ORIGINAL_PATH/src/main/java/org/apache/commons/math/util/OpenIntToDoubleHashMap.java MODIFIED_PATH/src/main/java/org/apache/commons/math/util/OpenIntToDoubleHashMap.java
--- ORIGINAL_PATH/src/main/java/org/apache/commons/math/util/OpenIntToDoubleHashMap.java
+++ MODIFIED_PATH/src/main/java/org/apache/commons/math/util/OpenIntToDoubleHashMap.java
@@ -188,7 +188,11 @@
     final double previous = values[index];
     values[index] = missingEntries;
     --size;
-    ++count;
+    if (index < 0) {
+      throw MathRuntimeException.createArrayIndexOutOfBoundsException(
+          LocalizedFormats.CANNOT_SET_AT_NEGATIVE_INDEX, index);
+    }
+    index = changeIndexSignindex;
     return previous;
   }
   public double put(final int key, final double value) {
